<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Constru App | Nueva Solicitud</title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <link rel="stylesheet" href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
  <link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">
  <link rel="stylesheet" href="plugins/jqvmap/jqvmap.min.css">
  <link rel="stylesheet" href="dist/css/adminlte.min.css">
  <link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">
  <link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css">

</head>

<body id="new_requestDIV" style="display: none;" class="hold-transition sidebar-mini layout-fixed">
  <div class="wrapper">


    <div class="preloader flex-column justify-content-center align-items-center">
      <img class="animation__shake" src="dist/img/AdminLTELogo.png" alt="AdminLTELogo" height="60" width="60">
    </div>
    <nav class="main-header navbar navbar-expand navbar-white navbar-light">

      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
          <a href="requests.html" class="nav-link">SOLICITUDES</a>
        </li>

      </ul>
      <ul class="navbar-nav ml-auto">

        <li class="nav-item dropdown">
          <a class="nav-link" data-toggle="dropdown" href="#">
            <i class="far fa-bell"></i>
            <span class="badge badge-danger navbar-badge">3</span>
          </a>
          <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
            <a href="#" class="dropdown-item">
              <div class="media">
                <img src="dist/img/user1-128x128.jpg" alt="User Avatar" class="img-size-50 mr-3 img-circle">
                <div class="media-body">
                  <h3 class="dropdown-item-title">
                    Brad Diesel
                    <span class="float-right text-sm text-danger"><i class="fas fa-star"></i></span>
                  </h3>
                  <p class="text-sm">Call me whenever you can...</p>
                  <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
                </div>
              </div>
            </a>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item">

              <div class="media">
                <img src="dist/img/user8-128x128.jpg" alt="User Avatar" class="img-size-50 img-circle mr-3">
                <div class="media-body">
                  <h3 class="dropdown-item-title">
                    John Pierce
                    <span class="float-right text-sm text-muted"><i class="fas fa-star"></i></span>
                  </h3>
                  <p class="text-sm">I got your message bro</p>
                  <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
                </div>
              </div>
            </a>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item">
              <div class="media">
                <img src="dist/img/user3-128x128.jpg" alt="User Avatar" class="img-size-50 img-circle mr-3">
                <div class="media-body">
                  <h3 class="dropdown-item-title">
                    Nora Silvester
                    <span class="float-right text-sm text-warning"><i class="fas fa-star"></i></span>
                  </h3>
                  <p class="text-sm">The subject goes here</p>
                  <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
                </div>
              </div>

            </a>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item dropdown-footer">See All Messages</a>
          </div>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link" data-toggle="dropdown" href="#">Qasim</a>
          <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
            <a href="#" class="dropdown-item">Logout</a>


          </div>
        </li>

      </ul>
    </nav>

    <aside class="main-sidebar sidebar-dark-primary elevation-4">

      <a href="index3.html" class="brand-link">
        <p class="brand-text font-weight-light" style="text-align: center; font-size: 30px; letter-spacing: 1px">CONSTRU
          <strong>APP</strong> </p>
      </a>


      <div class="sidebar">

        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
          <div class="image">

            <i class="fas fa-search fa-user" style="font-size: 30px; color: #fff; margin-top: 12px"></i>
          </div>
          <div class="info">
            <a href="#" class="d-block">Alexander Pierce</a>
            <a class="d-block" style="font-size: 14px; color: #00e64d; font-weight: 500">Online</a>
          </div>
        </div>



        <nav class="mt-2">
          <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">

            <li class="nav-header">BODEGUERO</li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Ver Solicitudes</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Añadir Solicitud</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Lista De Solicitudes</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Entrega Al Personal</p>

              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Recepcion Del Personal</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Recepcion Proveedor</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="fas fa-circle nav-icon"></i>
                <p>Invantario</p>
              </a>
            </li>


            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="nav-icon far fa-circle text-warning"></i>
                <p>Logout</p>
              </a>
            </li>

          </ul>
        </nav>

      </div>

    </aside>


    <div class="content-wrapper">
      <section class="content">
        <div class="container-fluid">
          <div class="row">
           
            <div class="col-md-12" style="margin-top: 20px;">
              
              <div class="card card-primary">
                <div class="card-header">
                  <h3 class="card-title"></h3>Nueva Solicitud</h3>
                </div>
                <form>
                  <div class="card-body">
                    <div class="row">
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Solicitante Rut</label>
                          <input type="text" class="form-control form-control-sm" readonly id="exampleInputEmail1">
                        </div>

                      </div>
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Solicitante Nombre</label>
                          <input type="email" class="form-control form-control-sm" id="exampleInputEmail1" readonly>
                        </div>

                      </div>
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Cargo Solicitante</label>
                          <input type="email" class="form-control form-control-sm" id="exampleInputEmail1" readonly>
                        </div>

                      </div>
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Decha De Entrada</label>
                          <input type="email" class="form-control form-control-sm" id="exampleInputEmail1" readonly>
                        </div>

                      </div>

                    </div>
                    <div class="row">
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Obra</label>
                          <select class="form-control form-control-sm" id="exampleInputPassword1">
                            <option value="">Por Favor Seleccione</option>
                          </select>
                        </div>

                      </div>
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Supervisor</label>
                          <select class="form-control form-control-sm" id="exampleInputPassword1">
                            <option value="">Por Favor Seleccione</option>
                          </select>
                        </div>

                      </div>

                    </div>
                    <div class="form-group">
                      <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Título</label>
                      <input type="password" class="form-control form-control-sm" id="exampleInputPassword1">
                    </div>
                    <div class="form-group">
                      <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Descripción</label>
                      <textarea class="form-control form-control-sm" rows="3"></textarea>
                    </div>
                    <div class="row">
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Material</label>
                          <select class="form-control form-control-sm" id="exampleInputPassword1">
                            <option value="">Por Favor Seleccione</option>
                          </select>
                        </div>

                      </div>
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Tipo</label>
                          <input type="email" class="form-control form-control-sm" id="exampleInputEmail1" readonly>
                        </div>

                      </div>
                      <div class="col">
                        <div class="form-group">
                          <label for="exampleInputEmail1" style="font-weight: 500; font-size: 16px;">Cantidad</label>
                          <input type="email" class="form-control form-control-sm" id="exampleInputEmail1">
                        </div>

                      </div>
                      <div class="col">
                        <button class="btn-sm btn-success" style="margin-top: 30px;">Agregar</button>


                      </div>

                    </div>
                    
                    <div class="row">
                      <div class="col-12">
                        <table class="table table-bordered">
                          <thead>
                            <tr>
                              <th scope="col">S.No</th>
                              <th scope="col">Material</th>
                              <th scope="col">Tipo</th>
                              <th scope="col">Cantidad</th>
                              <th scope="col">Actions</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <th scope="row">1</th>
                              <td>Bootstrap 4 CDN and Starter Template</td>
                              <td>Cristina</td>
                              <td>2.846</td>
                              <td>
                                
                                <button type="button" style="width: 100%;" class="btn btn-danger"><i class="far fa-trash-alt"></i>&nbsp&nbsp  Borrar Material</button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  <!-- /.card-body -->
  
                  <div class="card-footer">
                    <button type="submit" class="btn btn-primary">Submit</button>
                  </div>
                </form>
              </div>
              
             
            
  
            </div>
            
            
          </div>
          
        </div>
      </section>

    </div>

    <footer class="main-footer">
      <p style="text-align: center">Copyright &copy; 2021 <a href="#">ConstruApp</a>. All rights reserved.</p>
      
     
    </footer>
    <aside class="control-sidebar control-sidebar-dark">
    </aside>
  </div>

  <script src="plugins/jquery/jquery.min.js"></script>
  <script src="plugins/jquery-ui/jquery-ui.min.js"></script>
  <script>
    $.widget.bridge('uibutton', $.ui.button)
  </script>
  <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="plugins/chart.js/Chart.min.js"></script>
  <script src="plugins/sparklines/sparkline.js"></script>
  <script src="plugins/jqvmap/jquery.vmap.min.js"></script>
  <script src="plugins/jqvmap/maps/jquery.vmap.usa.js"></script>
  <script src="plugins/jquery-knob/jquery.knob.min.js"></script>
  <script src="plugins/moment/moment.min.js"></script>
  <script src="plugins/daterangepicker/daterangepicker.js"></script>
  <script src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
  <script src="plugins/summernote/summernote-bs4.min.js"></script>
  <script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
  <script src="dist/js/adminlte.js"></script>
  <script src="dist/js/demo.js"></script>
  <script src="dist/js/pages/dashboard.js"></script>
  <script src="dist/js/additional-methods.min.js"></script>
  <script src="dist/js/jquery.validate.min.js"></script>
  <script>
    $(document).ready(function () {

     
     
      $.ajax({
        type: "POST",
        url: "../controllers/controller.php",
        dataType: "JSON",
        data: { action: "get_user" },
        success: function (response) {
          if(response["user"] && response["login"] == true)
          {
            $("#rut_grocer_Input").val(response["user"]["RUT"]);
            $("#grocer_name_Input").val(response["user"]["NAME"]);
            


          }
          





        }

      });

      $(window).keydown(function (event) {
        if (event.keyCode == 13) {
          event.preventDefault();
          return false;
        }





      });
      $('#req_title_Input').focus();
      $('#req_title_Input').keydown(function (event) {
        if (event.keyCode == 13) {
          if ($(this).val() != "" || $(this).val() != null) {
            $("#req_title_Input").css("border", "1px solid #e5e9f2");
            $("#req_desc_Input").focus();
          }
          if ($(this).val() == "" || $(this).val() == null) {
            $("#req_title_Input").css("border", "1px solid red");
            $("#req_title_Input").focus();
          }


        }
      });
      $('#req_desc_Input').keydown(function (event) {
        if (event.keyCode == 13) {
          if ($(this).val() != "" || $(this).val() != null) {
            $("#req_desc_Input").css("border", "1px solid #e5e9f2");
            $("#importence_Input").focus().select()
          }
          if ($(this).val() == "" || $(this).val() == null) {
            $("#req_desc_Input").css("border", "1px solid red");
            $("#req_desc_Input").focus();
          }


        }
      });
      $('#construction_Input').keydown(function (event) {
        if (event.keyCode == 13) {
          if ($(this).val() != "" || $(this).val() != null) {
            $("#construction_Input").css("border", "1px solid #e5e9f2");
            $("#request_to_Input").focus().select()
          }
          if ($(this).val() == "" || $(this).val() == null) {
            $("#construction_Input").css("border", "1px solid red");
            $("#construction_Input").focus();
          }


        }
      });
      $('#request_to_Input').keydown(function (event) {
        if (event.keyCode == 13) {
          if ($(this).val() != "" || $(this).val() != null) {
            $("#request_to_Input").css("border", "1px solid #e5e9f2");
            $("#supervisor_Input").focus().select()
          }
          if ($(this).val() == "" || $(this).val() == null) {
            $("#request_to_Input").css("border", "1px solid red");
            $("#request_to_Input").focus();
          }


        }
      });
      $('#supervisor_Input').keydown(function (event) {
        if (event.keyCode == 13) {
          if ($(this).val() != "" || $(this).val() != null) {
            $("#supervisor_Input").css("border", "1px solid #e5e9f2");
            $("#btn_submit").focus();
          }
          if ($(this).val() == "" || $(this).val() == null) {
            $("#supervisor_Input").css("border", "1px solid red");
            $("#supervisor_Input").focus();
          }


        }
      });
      $('#importence_Input').on('change', function () {
        if ($(this).val() != "" || $(this).val() != null) {
          $("#importence_Input").css("border", "1px solid #e5e9f2");
          $("#construction_Input").focus();
        }
        if ($(this).val() == "" || $(this).val() == null) {
          $("#importence_Input").css("border", "1px solid red");
          $("#importence_Input").focus();
        }
      });


      $('#requestForm').validate({ // initialize the plugin
        rules: {
          request_type_Input: {
            required: true,

          },
          rut_grocer_Input: {
            required: true,

          },
          grocer_name_Input: {
            required: true,

          },
          req_title_Input: {
            required: true,

          },

          importence_Input: {
            required: true,

          },
          construction_Input: {
            required: true,

          },
          request_to_Input: {
            required: true,

          },
          supervisor_Input: {
            required: true,
            digits: true,
          },

        },
        messages: {
          request_type_Input: {
            required: "Este Campo Es Obligatorio",

          },
          rut_grocer_Input: {
            required: "Este Campo Es Obligatorio",

          },
          grocer_name_Input: {
            required: "Este Campo Es Obligatorio",

          },
          req_title_Input: {
            required: "Este Campo Es Obligatorio",

          },

          importence_Input: {
            required: "Este Campo Es Obligatorio",

          },
          construction_Input: {
            required: "Este Campo Es Obligatorio",

          },
          request_to_Input: {
            required: "Este Campo Es Obligatorio",

          },
          supervisor_Input: {
            required: "Este Campo Es Obligatorio",

          },


        },

        errorPlacement: function (error, element) {

          $(element).next("small").text($(error).text());

        },
        success: function (element) {
          $(element).next("small").text("");
        },
      });

      $.ajax({
        type: "POST",
        url: "../controllers/controller.php",
        data: { action: "get_lovs"},
        dataType: "JSON",
        success: function (response) {
          
         if(response)
         {
          jQuery.each(response["lov_const"], function (index, value) {
            $("#construction_Input").append("<option value=" + value['CONS_ID'] + " style='text-transform: initial'>" + value['NAME'] + "</option>");


          });
          jQuery.each(response["lov_supervisor"], function (index, value) {
            $("#supervisor_Input").append("<option value=" + value['SUPERVISOR_ID'] + " style='text-transform: initial'>" + value['SUPERVISOR_NAME'] + "</option>");


          });
          jQuery.each(response["lov_supervisor"], function (index, value) {
            $("#request_to_Input").append("<option value=" + value['SUPERVISOR_ID'] + " style='text-transform: initial'>" + value['SUPERVISOR_NAME'] + "</option>");


          });
         }





        }

      });

      $("#requestForm").on("submit", function (e) {
        $("#btn_submit").css("display", "none");
        e.preventDefault();
        if ($("#requestForm").valid() == true) {
          $.ajax({
            type: "POST",
            url: "../controllers/controller.php",
            dataType: "JSON",
            data: $("#requestForm").serialize(),
            success: function (response) {
              if(response["request"] == true) 
              {
                alert("Solicitud Enviada Con éxito, Gracias !");
                window.location.href = "requests.html";

              }
              if (response["request"] == false) {
                alert("Ha Ocurrido Un Error. Por Favor Intente De Nuevo");

              }

            }

          });


        }
        

      });








    });










  </script>
</body>

</html>